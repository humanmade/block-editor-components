!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("@wordpress/api-fetch"),require("@wordpress/block-editor"),require("@wordpress/blocks"),require("@wordpress/components"),require("@wordpress/data"),require("@wordpress/dom"),require("@wordpress/element"),require("@wordpress/html-entities"),require("@wordpress/i18n"),require("@wordpress/url"),require("react")):"function"===typeof define&&define.amd?define("@humanmade/block-editor-components",["wp.apiFetch","wp.blockEditor","wp.blocks","wp.components","wp.data","wp.dom","wp.element","wp.htmlEntities","wp.i18n","wp.url","React"],t):"object"===typeof exports?exports["@humanmade/block-editor-components"]=t(require("@wordpress/api-fetch"),require("@wordpress/block-editor"),require("@wordpress/blocks"),require("@wordpress/components"),require("@wordpress/data"),require("@wordpress/dom"),require("@wordpress/element"),require("@wordpress/html-entities"),require("@wordpress/i18n"),require("@wordpress/url"),require("react")):e["@humanmade/block-editor-components"]=t(e["wp.apiFetch"],e["wp.blockEditor"],e["wp.blocks"],e["wp.components"],e["wp.data"],e["wp.dom"],e["wp.element"],e["wp.htmlEntities"],e["wp.i18n"],e["wp.url"],e.React)}(self,((e,t,r,n,o,l,i,a,s,c,u)=>(()=>{"use strict";var d={167:t=>{t.exports=e},221:e=>{e.exports=t},2:e=>{e.exports=r},390:e=>{e.exports=n},866:e=>{e.exports=o},533:e=>{e.exports=l},227:e=>{e.exports=i},632:e=>{e.exports=a},914:e=>{e.exports=s},55:e=>{e.exports=c},639:e=>{e.exports=u}},p={};function m(e){var t=p[e];if(void 0!==t)return t.exports;var r=p[e]={exports:{}};return d[e](r,r.exports,m),r.exports}m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},m.d=(e,t)=>{for(var r in t)m.o(t,r)&&!m.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var v={};return(()=>{function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.apply(this,arguments)}m.r(v),m.d(v,{FetchAllTermSelectControl:()=>d,FileControls:()=>f,ImageControl:()=>k,LinkToolbar:()=>y,PlainTextWithLimit:()=>S,PostTitleControl:()=>_,PostTypeCheck:()=>x,RichTextWithLimit:()=>C,createOptionFromPost:()=>L,createOptionFromTerm:()=>$,createOptionsFromPosts:()=>D,createOptionsFromPostsWithHierarchy:()=>I,createOptionsFromTerms:()=>W,createOptionsFromTermsWithHierarchy:()=>H,getImageDataForSize:()=>R,useActiveBlockStyle:()=>P,useBlockStyles:()=>O,useDisallowedBlocks:()=>B,useMeta:()=>F,useRenderAppenderWithBlockLimit:()=>A,useSetAttribute:()=>N,withActiveVariation:()=>z});var t=m(227),r=m(639),n=m(167),o=m.n(n),l=m(390),i=m(866),a=m(914),s=m(55);const c={label:"",value:""},u={disabled:!0,label:(0,a.__)("No items found!","block-editor-components"),value:""};const d=function(n){const{defaultOption:a=c,fallbackOption:d=u,taxonomy:p,...m}=n,[v,f]=(0,r.useState)(),[h,b]=(0,r.useState)(),g=(0,i.useSelect)((e=>{var t;return null===(t=e("core").getTaxonomy(p))||void 0===t?void 0:t.rest_base}),[p]);return(0,r.useEffect)((()=>{g&&(async()=>{try{const e=await o()({path:(0,s.addQueryArgs)(`/wp/v2/${g}`,{_fields:"id,name",context:"view",per_page:-1})});if(null===e||void 0===e||!e.length)return void b([d]);b([...a?[a]:[],...W(e)])}catch(v){f(v.toString())}})()}),[g,a,d]),v?(0,t.createElement)(l.Notice,{status:"error"},(0,t.createElement)("p",null,v)):h?(0,t.createElement)(l.SelectControl,e({},m,{options:h})):(0,t.createElement)(l.Spinner,null)};var p=m(221);function f(r){const{value:n,onChange:o,...i}=r;return(0,t.createElement)(p.MediaUploadCheck,null,(0,t.createElement)(p.MediaUpload,e({},i,{render:e=>{let{open:r}=e;return(0,t.createElement)(l.ToolbarGroup,null,(0,t.createElement)(l.ToolbarButton,{icon:"admin-links",label:n?(0,a.__)("Edit file","block-editor-components"):(0,a.__)("Select file","block-editor-components"),onClick:r}),n&&(0,t.createElement)(l.ToolbarButton,{icon:"editor-unlink",label:(0,a.__)("Deselect file","block-editor-components"),onClick:()=>o(null)}))},value:n,onSelect:o})))}const h=["image"],b=(0,a.__)("Select image","block-editor-components"),g=(0,a.__)("Select Image","block-editor-components"),w=(0,a.__)("Remove image","block-editor-components");function k(e){const{buttonText:r=b,className:n,help:o,id:i,label:a,modalTitle:s=g,removeButtonText:c=w,value:u,onChange:d}=e;return(0,t.createElement)(l.BaseControl,{className:`${n} ${u?"has-image":""}`.trim(),help:o,id:i,label:a},(0,t.createElement)(p.MediaUploadCheck,{fallback:()=>u&&(0,t.createElement)("img",{alt:"",src:u})},(0,t.createElement)(p.MediaUpload,{allowedTypes:h,render:e=>{let{open:n}=e;return(0,t.createElement)(l.Button,{onClick:n},u?(0,t.createElement)("img",{alt:"",src:u}):r)},title:s,onSelect:d})),u&&(0,t.createElement)(l.Button,{isDestructive:!0,onClick:()=>d(null)},c))}function y(e){const{onChange:n,opensInNewTab:o,url:i}=e,[s,c]=(0,r.useState)(!1),u=(0,r.useMemo)((()=>[{icon:"admin-links",title:(0,a.__)("Link","block-editor-components"),isActive:(null===i||void 0===i?void 0:i.length)>0,onClick:()=>c(!s)}]),[c,s,i]),d=(0,r.useMemo)((()=>({url:i,opensInNewTab:o})),[o,i]);return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.Toolbar,{controls:u}),s&&(0,t.createElement)(l.Popover,null,(0,t.createElement)(p.__experimentalLinkControl,{forceIsEditingLink:s,opensInNewTab:o,value:d,onChange:n})))}function S(n){var o;const{className:l,limit:i=0,onChange:a,...s}=n,[c,u]=(0,r.useState)(i&&(null===(o=n.value)||void 0===o?void 0:o.length)>i);return(0,t.createElement)(p.PlainText,e({className:`${l} limit-text ${c?"invalid":""}`.trim(),onChange:e=>{i&&e.length>i?c||u(!0):(c&&u(!1),a(e))}},s))}const E=/[\r\n]+/g;function _(n){const{editPost:o}=(0,i.useDispatch)("core/editor"),l=(0,i.useSelect)((e=>e("core/editor").getEditedPostAttribute("title")),[]),a=(0,r.useCallback)((e=>o({title:e.replace(E," ")})),[o]);return(0,t.createElement)(p.RichText,e({},n,{allowedFormats:[],value:l,onChange:a}))}function x(e){var t;const{postType:r}=e;return(0,i.useSelect)((e=>e("core/editor").getCurrentPostType()),[])===r?e.children:null!==(t=e.fallback)&&void 0!==t?t:null}var T=m(533);function C(n){var o;const{className:l,limit:i=0,onChange:a,...s}=n,c=(0,r.useRef)(),[u,d]=(0,r.useState)(i&&(null===(o=n.value)||void 0===o?void 0:o.length)>i),[m,v]=(0,r.useState)(!1);return(0,t.createElement)(p.RichText,e({ref:c,className:`${l} limit-text ${u?"invalid":""}`.trim(),onChange:e=>{if(i&&(0,T.__unstableStripHTML)(e).length>i)return v(!1),c.current.innerHTML=n.value,(e=>{const t=document.createRange();t.selectNodeContents(e),t.collapse(!1);const r=window.getSelection();r.removeAllRanges(),r.addRange(t)})(c.current),void(u||d(!0));m&&u&&d(!1),v(!0),a(e)}},s))}const q=/^is-style-/;function P(e,t){const{blockStyles:n,defaultStyle:o}=O(e),l=(0,r.useMemo)((()=>function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().replace(/\s+/," ").split(" ").map((e=>q.test(e)?e.replace(q,""):"")).filter(Boolean)}(t)),[t]);return(0,r.useMemo)((()=>{var e;return null!==(e=l.find((e=>n.includes(e))))&&void 0!==e?e:o}),[n,l,o])}function O(e){const t=(0,i.useSelect)((t=>t("core/blocks").getBlockStyles(e)),[e]);return(0,r.useMemo)((()=>{var e,r;return{blockStyles:t.map((e=>{let{name:t}=e;return t})),defaultStyle:null!==(e=null===(r=t.find((e=>{let{isDefault:t}=e;return t})))||void 0===r?void 0:r.name)&&void 0!==e?e:""}}),[t])}var M=m(2);function B(e){return(0,r.useMemo)((()=>{const t=(0,M.getBlockTypes)();return null!==t&&void 0!==t&&t.length?t.filter((t=>{let{name:r,parent:n}=t;return"undefined"===typeof n&&!e.includes(r)})).map((e=>{let{name:t}=e;return t})):[]}),[e])}function F(e,t){var n;const{editPost:o}=(0,i.useDispatch)("core/editor"),l=(0,i.useSelect)((e=>e("core/editor").getEditedPostAttribute("meta"))),a=(0,r.useCallback)((t=>o({meta:{[e]:t}})),[o,e]);return[null!==(n=null===l||void 0===l?void 0:l[e])&&void 0!==n?n:t,a]}function A(e,t,r){return(0,i.useSelect)((n=>{const{innerBlocks:o}=n("core/block-editor").getBlock(e);return(null===o||void 0===o?void 0:o.length)<t&&r}),[])}function N(e,t,n){return(0,r.useCallback)((function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return t({[e]:r})}),[e,n,t])}function R(e,t){var r,n;const o=null!==(r=null===e||void 0===e?void 0:e.sizes)&&void 0!==r?r:null===e||void 0===e||null===(n=e.media_details)||void 0===n?void 0:n.sizes,l=null===o||void 0===o?void 0:o[t];return l?{src:l.url||l.source_url,width:l.width,height:l.height}:null}var j=m(632);function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const{id:r,title:n}=e;return{label:t+(0,j.decodeEntities)(n.rendered||(0,a.sprintf)((0,a.__)("#%d (no title)","block-editor-components"),r)),value:r}}function D(e){return e.map((e=>L(e)))}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((e=>{let{children:r=[],...n}=e;return[L(n,"\u2014 ".repeat(t)),...I(r,t+1)]})).flat()}function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const{id:r,name:n}=e;return{label:t+(0,j.decodeEntities)(n||(0,a.sprintf)((0,a.__)("#%d (no name)","block-editor-components"),r)),value:r}}function W(e){return e.map((e=>$(e)))}function H(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((e=>{let{children:r=[],...n}=e;return[$(n,"\u2014 ".repeat(t)),...H(r,t+1)]})).flat()}function U(e){return(t,r)=>e.every((e=>t[e]===r[e]))}function z(e){var t;if(null!==(t=e.variations)&&void 0!==t&&t.length){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];const t=U(n);e.variations=e.variations.map((e=>(e.isActive=t,e)))}return e}})(),v})()));