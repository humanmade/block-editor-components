!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("wp.apiFetch"),require("wp.blockEditor"),require("wp.blocks"),require("wp.components"),require("wp.data"),require("wp.dom"),require("wp.element"),require("wp.htmlEntities"),require("wp.i18n"),require("wp.url"),require("react")):"function"===typeof define&&define.amd?define("@humanmade/block-editor-components",["wp.apiFetch","wp.blockEditor","wp.blocks","wp.components","wp.data","wp.dom","wp.element","wp.htmlEntities","wp.i18n","wp.url","React"],t):"object"===typeof exports?exports["@humanmade/block-editor-components"]=t(require("wp.apiFetch"),require("wp.blockEditor"),require("wp.blocks"),require("wp.components"),require("wp.data"),require("wp.dom"),require("wp.element"),require("wp.htmlEntities"),require("wp.i18n"),require("wp.url"),require("react")):e["@humanmade/block-editor-components"]=t(e["wp.apiFetch"],e["wp.blockEditor"],e["wp.blocks"],e["wp.components"],e["wp.data"],e["wp.dom"],e["wp.element"],e["wp.htmlEntities"],e["wp.i18n"],e["wp.url"],e.React)}(self,((e,t,n,o,r,l,i,a,c,u,s)=>(()=>{"use strict";var d={611:t=>{t.exports=e},356:e=>{e.exports=t},84:e=>{e.exports=n},555:e=>{e.exports=o},262:e=>{e.exports=r},811:e=>{e.exports=l},503:e=>{e.exports=i},594:e=>{e.exports=a},516:e=>{e.exports=c},928:e=>{e.exports=u},639:e=>{e.exports=s}},p={};function m(e){var t=p[e];if(void 0!==t)return t.exports;var n=p[e]={exports:{}};return d[e](n,n.exports,m),n.exports}m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},m.d=(e,t)=>{for(var n in t)m.o(t,n)&&!m.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var v={};return(()=>{function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e.apply(this,arguments)}m.r(v),m.d(v,{FetchAllTermSelectControl:()=>d,FileControls:()=>f,ImageControl:()=>k,LinkToolbar:()=>y,PlainTextWithLimit:()=>E,PostTitleControl:()=>_,PostTypeCheck:()=>x,RichTextWithLimit:()=>C,createOptionFromPost:()=>L,createOptionFromTerm:()=>$,createOptionsFromPosts:()=>D,createOptionsFromPostsWithHierarchy:()=>I,createOptionsFromTerms:()=>W,createOptionsFromTermsWithHierarchy:()=>H,getImageDataForSize:()=>R,useActiveBlockStyle:()=>P,useBlockStyles:()=>O,useDisallowedBlocks:()=>B,useMeta:()=>F,useRenderAppenderWithBlockLimit:()=>A,useSetAttribute:()=>N,withActiveVariation:()=>z});var t=m(503),n=m(639),o=m(611),r=m.n(o),l=m(555),i=m(262),a=m(516),c=m(928);const u={label:"",value:""},s={disabled:!0,label:(0,a.__)("No items found!","block-editor-components"),value:""};const d=function(o){const{defaultOption:a=u,fallbackOption:d=s,taxonomy:p,...m}=o,[v,f]=(0,n.useState)(),[h,b]=(0,n.useState)(),g=(0,i.useSelect)((e=>{var t;return null===(t=e("core").getTaxonomy(p))||void 0===t?void 0:t.rest_base}),[p]);return(0,n.useEffect)((()=>{g&&(async()=>{try{const e=await r()({path:(0,c.addQueryArgs)(`/wp/v2/${g}`,{_fields:"id,name",context:"view",per_page:-1})});if(null===e||void 0===e||!e.length)return void b([d]);b([...a?[a]:[],...W(e)])}catch(v){f(v.toString())}})()}),[g,a,d]),v?(0,t.createElement)(l.Notice,{status:"error"},(0,t.createElement)("p",null,v)):h?(0,t.createElement)(l.SelectControl,e({},m,{options:h})):(0,t.createElement)(l.Spinner,null)};var p=m(356);function f(n){const{value:o,onChange:r,...i}=n;return(0,t.createElement)(p.MediaUploadCheck,null,(0,t.createElement)(p.MediaUpload,e({},i,{render:e=>{let{open:n}=e;return(0,t.createElement)(l.ToolbarGroup,null,(0,t.createElement)(l.ToolbarButton,{icon:"admin-links",label:o?(0,a.__)("Edit file","block-editor-components"):(0,a.__)("Select file","block-editor-components"),onClick:n}),o&&(0,t.createElement)(l.ToolbarButton,{icon:"editor-unlink",label:(0,a.__)("Deselect file","block-editor-components"),onClick:()=>r(null)}))},value:o,onSelect:r})))}const h=["image"],b=(0,a.__)("Select image","block-editor-components"),g=(0,a.__)("Select Image","block-editor-components"),w=(0,a.__)("Remove image","block-editor-components");function k(e){const{buttonText:n=b,className:o,help:r,id:i,label:a,modalTitle:c=g,removeButtonText:u=w,value:s,onChange:d}=e;return(0,t.createElement)(l.BaseControl,{className:`${o} ${s?"has-image":""}`.trim(),help:r,id:i,label:a},(0,t.createElement)(p.MediaUploadCheck,{fallback:()=>s&&(0,t.createElement)("img",{alt:"",src:s})},(0,t.createElement)(p.MediaUpload,{allowedTypes:h,render:e=>{let{open:o}=e;return(0,t.createElement)(l.Button,{onClick:o},s?(0,t.createElement)("img",{alt:"",src:s}):n)},title:c,onSelect:d})),s&&(0,t.createElement)(l.Button,{isDestructive:!0,onClick:()=>d(null)},u))}function y(e){const{onChange:o,opensInNewTab:r,url:i}=e,[c,u]=(0,n.useState)(!1),s=(0,n.useMemo)((()=>[{icon:"admin-links",title:(0,a.__)("Link","block-editor-components"),isActive:(null===i||void 0===i?void 0:i.length)>0,onClick:()=>u(!c)}]),[u,c,i]),d=(0,n.useMemo)((()=>({url:i,opensInNewTab:r})),[r,i]);return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.Toolbar,{controls:s}),c&&(0,t.createElement)(l.Popover,null,(0,t.createElement)(p.__experimentalLinkControl,{forceIsEditingLink:c,opensInNewTab:r,value:d,onChange:o})))}function E(o){var r;const{className:l,limit:i=0,onChange:a,...c}=o,[u,s]=(0,n.useState)(i&&(null===(r=o.value)||void 0===r?void 0:r.length)>i);return(0,t.createElement)(p.PlainText,e({className:`${l} limit-text ${u?"invalid":""}`.trim(),onChange:e=>{i&&e.length>i?u||s(!0):(u&&s(!1),a(e))}},c))}const S=/[\r\n]+/g;function _(o){const{editPost:r}=(0,i.useDispatch)("core/editor"),l=(0,i.useSelect)((e=>e("core/editor").getEditedPostAttribute("title")),[]),a=(0,n.useCallback)((e=>r({title:e.replace(S," ")})),[r]);return(0,t.createElement)(p.RichText,e({},o,{allowedFormats:[],value:l,onChange:a}))}function x(e){var t;const{postType:n}=e;return(0,i.useSelect)((e=>e("core/editor").getCurrentPostType()),[])===n?e.children:null!==(t=e.fallback)&&void 0!==t?t:null}var T=m(811);function C(o){var r;const{className:l,limit:i=0,onChange:a,...c}=o,u=(0,n.useRef)(),[s,d]=(0,n.useState)(i&&(null===(r=o.value)||void 0===r?void 0:r.length)>i),[m,v]=(0,n.useState)(!1);return(0,t.createElement)(p.RichText,e({ref:u,className:`${l} limit-text ${s?"invalid":""}`.trim(),onChange:e=>{if(i&&(0,T.__unstableStripHTML)(e).length>i)return v(!1),u.current.innerHTML=o.value,(e=>{const t=document.createRange();t.selectNodeContents(e),t.collapse(!1);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)})(u.current),void(s||d(!0));m&&s&&d(!1),v(!0),a(e)}},c))}const q=/^is-style-/;function P(e,t){const{blockStyles:o,defaultStyle:r}=O(e),l=(0,n.useMemo)((()=>function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().replace(/\s+/," ").split(" ").map((e=>q.test(e)?e.replace(q,""):"")).filter(Boolean)}(t)),[t]);return(0,n.useMemo)((()=>{var e;return null!==(e=l.find((e=>o.includes(e))))&&void 0!==e?e:r}),[o,l,r])}function O(e){const t=(0,i.useSelect)((t=>t("core/blocks").getBlockStyles(e)),[e]);return(0,n.useMemo)((()=>{var e,n;return{blockStyles:t.map((e=>{let{name:t}=e;return t})),defaultStyle:null!==(e=null===(n=t.find((e=>{let{isDefault:t}=e;return t})))||void 0===n?void 0:n.name)&&void 0!==e?e:""}}),[t])}var M=m(84);function B(e){return(0,n.useMemo)((()=>{const t=(0,M.getBlockTypes)();return null!==t&&void 0!==t&&t.length?t.filter((t=>{let{name:n,parent:o}=t;return"undefined"===typeof o&&!e.includes(n)})).map((e=>{let{name:t}=e;return t})):[]}),[e])}function F(e,t){var o;const{editPost:r}=(0,i.useDispatch)("core/editor"),l=(0,i.useSelect)((e=>e("core/editor").getEditedPostAttribute("meta"))),a=(0,n.useCallback)((t=>r({meta:{[e]:t}})),[r,e]);return[null!==(o=null===l||void 0===l?void 0:l[e])&&void 0!==o?o:t,a]}function A(e,t,n){return(0,i.useSelect)((o=>{const{innerBlocks:r}=o("core/block-editor").getBlock(e);return(null===r||void 0===r?void 0:r.length)<t&&n}),[])}function N(e,t,o){return(0,n.useCallback)((function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return t({[e]:n})}),[e,o,t])}function R(e,t){var n,o;const r=null!==(n=null===e||void 0===e?void 0:e.sizes)&&void 0!==n?n:null===e||void 0===e||null===(o=e.media_details)||void 0===o?void 0:o.sizes,l=null===r||void 0===r?void 0:r[t];return l?{src:l.url||l.source_url,width:l.width,height:l.height}:null}var j=m(594);function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const{id:n,title:o}=e;return{label:t+(0,j.decodeEntities)(o.rendered||(0,a.sprintf)((0,a.__)("#%d (no title)","block-editor-components"),n)),value:n}}function D(e){return e.map((e=>L(e)))}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((e=>{let{children:n=[],...o}=e;return[L(o,"\u2014 ".repeat(t)),...I(n,t+1)]})).flat()}function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const{id:n,name:o}=e;return{label:t+(0,j.decodeEntities)(o||(0,a.sprintf)((0,a.__)("#%d (no name)","block-editor-components"),n)),value:n}}function W(e){return e.map((e=>$(e)))}function H(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((e=>{let{children:n=[],...o}=e;return[$(o,"\u2014 ".repeat(t)),...H(n,t+1)]})).flat()}function U(e){return(t,n)=>e.every((e=>t[e]===n[e]))}function z(e){var t;if(null!==(t=e.variations)&&void 0!==t&&t.length){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];const t=U(o);e.variations=e.variations.map((e=>(e.isActive=t,e)))}return e}})(),v})()));